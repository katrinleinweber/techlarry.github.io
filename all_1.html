<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
    
  techlarry
  
  </title>
  
  
  <link href="atom.xml" rel="alternate" title="techlarry" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/foundation.min.css" />
    <link rel="stylesheet" href="asset/css/docs.css" />
    <script src="asset/js/vendor/modernizr.js"></script>
    <script src="asset/js/vendor/jquery.js"></script>
  <script src="asset/highlightjs/highlight.pack.js"></script>
  <link href="asset/highlightjs/styles/github.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript">
  function before_search(){
    var searchVal = 'site:larryim.cc ' + document.getElementById('search_input').value;
    document.getElementById('search_q').value = searchVal;
    return true;
  }
</script>
  </head>
  <body class="antialiased hide-extras">
    
    <div class="marketing off-canvas-wrap" data-offcanvas>
      <div class="inner-wrap">


<nav class="top-bar docs-bar hide-for-small" data-topbar>


  <section class="top-bar-section">
  <div class="row">
      <div style="position: relative;width:100%;"><div style="position: absolute; width:100%;">
        <ul id="main-menu" class="left">
        
        <li id=""><a target="_self" href="index.html">HomePage</a></li>
        
        <li id=""><a target="_self" href="archives.html">Archives</a></li>
        
        <li id=""><a target="_blank" href="wiki">WIKI</a></li>
        
        <li id=""><a target="_self" href="notebook.html">NOTEBOOK</a></li>
        
        <li id=""><a target="_self" href="about.html">About</a></li>
        
        </ul>

        <ul class="right" id="search-wrap">
          <li>
<form target="_blank" onsubmit="return before_search();" action="http://google.com/search" method="get">
    <input type="hidden" id="search_q" name="q" value="" />
    <input tabindex="1" type="search" id="search_input"  placeholder="Search"/>
</form>
</li>
          </ul>
      </div></div>
  </div>
  </section>

</nav>

        <nav class="tab-bar show-for-small">
  <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
    <span> &nbsp; techlarry</span>
  </a>
</nav>

<aside class="left-off-canvas-menu">
      <ul class="off-canvas-list">
        
        <li><a target="_self" href="index.html">HomePage</a></li>
        
        <li><a target="_self" href="archives.html">Archives</a></li>
        
        <li><a target="_blank" href="wiki">WIKI</a></li>
        
        <li><a target="_self" href="notebook.html">NOTEBOOK</a></li>
        
        <li><a target="_self" href="about.html">About</a></li>
        

    <li><label>Categories</label></li>

        
            <li><a href="Leetcode.html">Leetcode</a></li>
        
            <li><a href="programming_language.html">编程语言</a></li>
        
            <li><a href="data_structure_and_algorithm.html">数据结构和算法</a></li>
        
            <li><a href="Python%E7%89%B9%E6%80%A7.html">Python特性</a></li>
        
            <li><a href="%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0.html">机器学习</a></li>
        
            <li><a href="Python%E7%A7%91%E5%AD%A6%E8%AE%A1%E7%AE%97%E4%B8%89%E7%BB%B4%E5%8F%AF%E8%A7%86%E5%8C%96.html">Python科学计算三维可视化</a></li>
        
            <li><a href="English.html">English</a></li>
        
            <li><a href="Computer%20System.html">Computer System</a></li>
        
            <li><a href="Deep%20Learning.html">Deep Learning</a></li>
        
            <li><a href="Linux%20%E7%B3%BB%E7%BB%9F%E7%BC%96%E7%A8%8B.html">Linux 系统编程</a></li>
        
            <li><a href="%E6%95%B0%E6%8D%AE%E5%BA%93.html">数据库</a></li>
        
            <li><a href="Tensorflow.html">Tensorflow</a></li>
        
            <li><a href="Big%20Data.html">Big Data</a></li>
        
            <li><a href="%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB.html">文献阅读</a></li>
        
            <li><a href="Tools.html">Tools</a></li>
         

      </ul>
    </aside>

<a class="exit-off-canvas" href="#"></a>


        <section id="main-content" role="main" class="scroll-container">
        
       

 <script type="text/javascript">
	$(function(){
		$('#menu_item_index').addClass('is_active');
	});
</script>
<div class="row">
	<div class="large-8 medium-8 columns">
		<div class="markdown-body home-categories">
		
			<div class="article">
                <a class="clearlink" href="Hadoop%20_the_definitive_guide_1-Hadoop_fundamentals.html">
                
                  <h1>Hadoop权威指南(I) - Hadoop基础知识</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h2 id="toc_0">1 初识Hadoop</h2>

<h3 id="toc_1">1.1 数据！数据！</h3>

<p>现在是数据大爆炸时代，全球数据总量远远超过了全世界每人一块硬盘中所能保存的数据总量。</p>

<ul>
<li>个人产生的数据正在快速增长
<ul>
<li>个人信息档案将日益普及（电话、邮件、文件、照片）</li>
</ul></li>
<li>物联网的机器设备产生的数据可能远远超过个人产生的数据 
<ul>
<li>机器日志、传感器网络、零售交易数据等</li>
</ul></li>
</ul>

<h3 id="toc_2">1.2 数据的存储与分析</h3>

<p>遇到的问题：硬盘存储容量不断提升，访问速度没有与时俱进</p>

<ul>
<li>读写硬盘中的数据需要更长时间</li>
</ul>

<p>解决方法： 同时从多个硬盘上读取数据，每个硬盘存储一部分数据</p>

<ul>
<li>虽然浪费了硬盘容量，但是由于用户的分析工作都是在不同时间点进行的，所以彼此之间的干扰并不太大</li>
</ul>

<p>新的问题：要对多个硬盘中的数据并行进行读写数据，还有更多问题要解决</p>

<ul>
<li>硬件故障问题：最常见的做法是系统保存数据的副本(replica)</li>
<li>大多数分析任务需要以某种方式结合大部分数据来共同完成分析，保证其正确性是一个非常大的挑战：MapReduce</li>
</ul>

<h3 id="toc_3">1.3 查询所有数据</h3>

<p>MapReduce是一个<strong>批量查询处理器</strong>，能够在合理的时间范围内处理针对整个数据集的动态查询。</p>

<h3 id="toc_4">1.4 不仅仅是批处理</h3>

<p>MapReduce基本上是一个批处理系统，并不适合交互式分析:</p>

<ul>
<li>你不可能执行一条查询并在几秒内或更短时间内得到结果；典型情况下，执行查询需要几分钟或更多时间。</li>
<li>MapReduce更适合没有用户在现场等待查询结果的离线使用场景。</li>
</ul>

<p>Hadoop的发展已经超越了批处理本身。</p>

<ul>
<li>Hadoop有时被用于指代一个更大的、多个项目组成的生态系统，而不仅仅是HDFS和MapReduce
<ul>
<li>HBase：使用HDFS做底层存储的键值存储模型。 </li>
<li>YARN: 集群资源管理系统</li>
</ul></li>
</ul>

<h3 id="toc_5">1.6 发展历史</h3>

<ul>
<li>Hadoop是Doug Cutting创建的，起源于开源网络搜索引擎<code>Apache Nutch</code>.</li>
<li>Apach Nutch是起始于2002年，并借鉴了“谷歌分布式文件系统(GFS)&quot;和MapReduce。</li>
<li>2006年，Doug Cutting加入雅虎，雅虎为此组织了专门的团队和资源，将Hadoop发展成能够以Web规模运行的系统。 </li>
<li>2008年，Hadoop已经成为Apache的顶级项目，证明了它的成功、多样化和生命力。</li>
<li>目前，Hadoop被主流企业广泛使用。在工业界，Hadoop已经是 <u><em>公认的大数据通用存储和分析平台</em></u> 。</li>
</ul>

<h2 id="toc_6">2 关于Mapreduce</h2>

<h2 id="toc_7">3 Hadoop分布式文件系统</h2>

<h2 id="toc_8">4 关于YARN</h2>

<h2 id="toc_9">5 Hadoop的I/O操作</h2>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2018/3/17</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='Big%20Data.html'>Big Data</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="hadoop_mapreduce.html">
                
                  <h1>Hadoop和MapReduce入门</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<ul>
<li>
<a href="#toc_0">Part I Big Data</a>
<ul>
<li>
<a href="#toc_1">2 data source</a>
</li>
<li>
<a href="#toc_2">3. big data</a>
</li>
<li>
<a href="#toc_3">4. big data solution</a>
</li>
<li>
<a href="#toc_4">5. Definition of Big Data</a>
</li>
<li>
<a href="#toc_5">6 challenges</a>
</li>
<li>
<a href="#toc_6">8 the 3vs</a>
</li>
<li>
<a href="#toc_7">9 data worth storing?</a>
</li>
<li>
<a href="#toc_8">11 variety</a>
</li>
<li>
<a href="#toc_9">15 velocity</a>
</li>
<li>
<a href="#toc_10">16 Doug intro</a>
</li>
<li>
<a href="#toc_11">17. core hadoop</a>
</li>
<li>
<a href="#toc_12">18. hadoop ecosystem</a>
</li>
</ul>
</li>
<li>
<a href="#toc_13">Part 2 HDFS and MapReduce</a>
</li>
<li>
<a href="#toc_14">Part 3 MapReduce Code</a>
</li>
<li>
<a href="#toc_15">Part 4 MapReduce Design Patterns</a>
</li>
</ul>


<p>来自<a href="https://cn.udacity.com/course/intro-to-hadoop-and-mapreduce--ud617">Udacity</a>课程Introduction to Hadoop and Mapreduce的笔记</p>

<h2 id="toc_0">Part I Big Data</h2>

<h3 id="toc_1">2 data source</h3>

<p>data increases</p>

<ul>
<li>phone data</li>
<li>online store</li>
</ul>

<p>how to store and process large amounts of data?</p>

<h3 id="toc_2">3. big data</h3>

<p>what is big data?</p>

<ul>
<li>order details for a store</li>
<li>all orders across 100s of stores</li>
<li>a person&#39;s stock portfoio</li>
<li>all stock transaction for the new york</li>
</ul>

<h3 id="toc_3">4. big data solution</h3>

<p>big data:</p>

<ul>
<li>all orders across 100s of stores</li>
<li>all stock transaction for the new york</li>
</ul>

<h3 id="toc_4">5. Definition of Big Data</h3>

<p>big data is data that is too big to process on a single machine</p>

<h3 id="toc_5">6 challenges</h3>

<ul>
<li>most data is worthless. false</li>
<li>data is created fast. true</li>
<li>data from different sources in various formats. true</li>
</ul>

<h3 id="toc_6">8 the 3vs</h3>

<ul>
<li>volumes: size of data 
<ul>
<li>reliable storage: find a cheaper way </li>
</ul></li>
<li>variety: data coming from  different source and format</li>
<li>velocity: speed of data generation</li>
</ul>

<h3 id="toc_7">9 data worth storing?</h3>

<ul>
<li>transactions</li>
<li>logs</li>
<li>business</li>
<li>user</li>
<li>sensor</li>
<li>medical</li>
<li>social</li>
</ul>

<p>all </p>

<h3 id="toc_8">11 variety</h3>

<p>data variety. for a long time, people use sql, mysql, oracle to store their data. the problem is that data needs to be fit in pre-defined tables. and a lot of data we deal these days tend to be unstructured or semi-structured data</p>

<h3 id="toc_9">15 velocity</h3>

<p>TB/day</p>

<h3 id="toc_10">16 Doug intro</h3>

<p>hadoop 之父 doug cutting</p>

<p>Here are the papers Google published about their <a href="http://static.googleusercontent.com/media/research.google.com/en/us/archive/gfs-sosp2003.pdf">distributed file system (GFS)</a> and their processing framework, <a href="http://static.googleusercontent.com/media/research.google.com/en/us/archive/mapreduce-osdi04.pdf">MapReduce</a><br/>
.</p>

<h3 id="toc_11">17. core hadoop</h3>

<p>store in hdfs, process with mapreduce</p>

<h3 id="toc_12">18. hadoop ecosystem</h3>

<p><img src="media/15315844145426/hadoop_ecosystem.png" alt="hadoop_ecosystem"/></p>

<h2 id="toc_13">Part 2 HDFS and MapReduce</h2>

<h2 id="toc_14">Part 3 MapReduce Code</h2>

<h2 id="toc_15">Part 4 MapReduce Design Patterns</h2>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2018/1/15</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='Big%20Data.html'>Big Data</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="head-first_java_note.html">
                
                  <h1>Head first Java</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<p>Notes, Head first Java, 2nd Edition</p>

<ul>
<li>
<a href="#toc_0">1 Dive in A Quick Dip</a>
</li>
<li>
<a href="#toc_1">2 Classes and objects</a>
<ul>
<li>
<a href="#toc_2">2.1 Object Oriented</a>
</li>
<li>
<a href="#toc_3">2.2 Class</a>
</li>
<li>
<a href="#toc_4">2.3 main</a>
</li>
</ul>
</li>
<li>
<a href="#toc_5">3 Primitives and references</a>
</li>
<li>
<a href="#toc_6">3.1 primitive variable</a>
</li>
<li>
<a href="#toc_7">3.2 Reference variable</a>
</li>
<li>
<a href="#toc_8">3.3 Array</a>
</li>
<li>
<a href="#toc_9">4 Methods use instance variables</a>
<ul>
<li>
<a href="#toc_10">4.1 Methods</a>
</li>
<li>
<a href="#toc_11">4.2 Getters and setters</a>
</li>
<li>
<a href="#toc_12">4.3 Encapsulation</a>
</li>
<li>
<a href="#toc_13">4.4 Instance variables</a>
</li>
<li>
<a href="#toc_14">4.5 Instance and local variables</a>
</li>
<li>
<a href="#toc_15">4.6 Comparing variables</a>
</li>
</ul>
</li>
<li>
<a href="#toc_16">5 Writing a Program</a>
</li>
<li>
<a href="#toc_17">6  Get to know the Java API</a>
</li>
<li>
<a href="#toc_18">7 Inheritance and polymorphism</a>
<ul>
<li>
<a href="#toc_19">7.1 overriding</a>
</li>
<li>
<a href="#toc_20">7.2 Polymorphism</a>
</li>
<li>
<a href="#toc_21">7.3 Method overloading</a>
</li>
</ul>
</li>
<li>
<a href="#toc_22">8 Interfaces and abstract classes</a>
<ul>
<li>
<a href="#toc_23">Abstract classes</a>
</li>
<li>
<a href="#toc_24">Abstract methods</a>
</li>
<li>
<a href="#toc_25">the ultimate superclass: Object</a>
</li>
<li>
<a href="#toc_26">Using polymorphic references of type Object has a price</a>
</li>
<li>
<a href="#toc_27">Interface</a>
</li>
<li>
<a href="#toc_28">Using <code>super</code></a>
</li>
</ul>
</li>
<li>
<a href="#toc_29">9 Constructors and garbage collection</a>
</li>
<li>
<a href="#toc_30">10 Numbers and statics</a>
</li>
</ul>


<h2 id="toc_0">1 Dive in A Quick Dip</h2>

<p>Java has friendly syntax, object-oriented features, memory management, and best of all - the promise of probability (write-one/run-anywhere).</p>

<p>You type a source code file(<code>.java</code>). compile it using the <code>javac</code> compiler, then run(<code>java</code>) the compiled bytecode(<code>.class</code>) on a java virtual machine.</p>

<p><img src="media/15321391987415/code_structure.png" alt="code_structure"/></p>

<p>Every Java application has to have at least one class, and at least one main method.</p>

<p>The main method <code>public static void main(String[] args){//your code goes here}</code>is where your program starts running.</p>

<p>Java has three standard looping constructs: <code>while</code>, <code>do-while</code>, and <code>for</code>.</p>

<p>A boolean and an integer are not compatible types in Java.</p>

<pre><code class="language-text">int x=1;
while (x) {} //wrong
</code></pre>

<p><code>System.out.println</code> inserts a newline, <code>System.out.print</code> keeps printing to the same line.</p>

<h2 id="toc_1">2 Classes and objects</h2>

<h3 id="toc_2">2.1 Object Oriented</h3>

<p>What do you like about OO? Some people say...</p>

<ul>
<li>It helps me design in a more natural way. Things have a way of evolving.</li>
<li>Not messing around with the code I&#39;ve already tested, just to add a new feature.</li>
<li>Reusing code in other applications. When I write a new class, I can make it flexible enough to be used in something new, later</li>
</ul>

<h3 id="toc_3">2.2 Class</h3>

<p>A class describes what an object <strong>knows</strong>(instance variables) and what an object <strong>does</strong>(methods).</p>

<p><img src="media/15321391987415/class.png" alt="class"/></p>

<p>What&#39;s the <strong>difference</strong> between a class and an object?</p>

<ul>
<li>A class is not an object. A class is the blueprint for an object. It tells the JVM <em>how</em> to make an object of that particular type. Each object made from that class have its <em>own</em> values for the instance variables of that class.</li>
</ul>

<p><img src="media/15321391987415/one_class_many_objects.png" alt="one_class_many_objects"/></p>

<h3 id="toc_4">2.3 main</h3>

<p>The two uses of main:</p>

<ul>
<li>to <strong><em>test</em></strong> your real class</li>
<li>to <strong><em>launch/start</em></strong> your Java application.</li>
</ul>

<h2 id="toc_5">3 Primitives and references</h2>

<p>Variables must always be declared with a name and a type. Variables come in two flavors: <strong>primitive</strong> and <strong>reference</strong>.(变量的生命必须有类型和名称。变量有两种：primitive和引用)</p>

<h2 id="toc_6">3.1 primitive variable</h2>

<p>A <em>primitive variable</em> value is the bits representing the value. primitive变量的值是表示该值的位。</p>

<h2 id="toc_7">3.2 Reference variable</h2>

<ul>
<li>A reference variable value is the bits representing a way to get to an object on the heap.引用变量的值是表示一种到达堆上的对象的方法的位。</li>
<li>A reference variable is like a remote control. Using the dot operator(<code>.</code>) on a reference variable is like pressing a button on the remote control to access a method or instance variables.</li>
<li>A reference variable has a value of <code>null</code> when it is not referencing any object.</li>
</ul>

<h2 id="toc_8">3.3 Array</h2>

<ul>
<li>An array is always an object, even if the array is declared to hold primitives. </li>
<li>Every element in an array is just a variable.</li>
</ul>

<p><u>The three steps of <strong>object declaration, creation and assignment</strong>.</u></p>

<p>(e.g. <code>Dog myDog = new Dog()</code>);</p>

<ul>
<li><strong>declare</strong> a reference variable: tell the JVM to allocate space for a reference variable, and names that variable myDog</li>
<li><strong>create</strong> an object: tells the JCM to allocate space for a new Dog object on the heap.</li>
<li><strong>Assigns</strong> the object to the reference variable.</li>
</ul>

<p><img src="media/15321391987415/three%20steps%20of%20object%20declaration,%20creation,%20and%20assignment.png" alt="three steps of object declaration, creation, and assignment"/></p>

<h2 id="toc_9">4 Methods use instance variables</h2>

<h3 id="toc_10">4.1 Methods</h3>

<p><strong>Class define what an object knows and what an object does.</strong> Things an object knows are its <em>instance variables</em>(state), things an object does are its <em>methods</em>(behavior).</p>

<p><strong>Methods</strong>:<br/>
<strong>A method uses parameters. A caller passes arguments.</strong></p>

<ul>
<li>Arguments are the things you pass into the methods.</li>
<li>If a method takes a parameters, you must pass it something.</li>
<li>Methods can return values. Every method is declared is declared with a return type.</li>
<li>If you declare a method to return a value, you <em>must</em> return a value of the declared type or a value that is <em>compatible</em> with the declared type.</li>
<li>Java is <strong>pass-by-value</strong>, which means <strong>pass-by-copy</strong>.</li>
</ul>

<h3 id="toc_11">4.2 Getters and setters</h3>

<p><strong>Getters</strong> and <strong>setters</strong> let you, well, <em>get and set things</em>.</p>

<ul>
<li>A Getter&#39;s sole purpose in life is to send back, as a return value, the value of whatever it is that particular Getter is supposed to be Getting.</li>
</ul>

<h3 id="toc_12">4.3 Encapsulation</h3>

<p>By forcing everybody to call a setter method, we can protect variables from unacceptable changes.</p>

<pre><code class="language-java">theCat.height = 0 //yikes! we can&#39;t let this happen

public void setHeight(int ht){
    if (ht&gt;9){ // we put in checks to guarantee a minimum cat height.
        height=ht;
    }
}
</code></pre>

<p>An <strong>encapsulation</strong> <em>starter</em> rule of thumb: <u>mark your instances variables <strong><em>private</em></strong>, and provide <strong><em>public</em></strong> getters and setters for access control.</u></p>

<ul>
<li>Encapsulations puts a force-field around instance variables, so nobody can set them to something <em>inappropriate</em>.</li>
<li>The point to setters (and getters, too) is that <strong><em>you can change your mind later, without breaking anybody else’s code</em></strong>!</li>
</ul>

<pre><code class="language-java">class GoodDog {
    private int size; //Make the instance variable private
    public int getSize() { // make the getter methods public
        return size; 
    }

    public void setSize(int s) {  // make the setter methods public
        size = s; 
    }

    // even though the methods don&#39;t really add new functionality,
    // the cool thing is that you can change your mind later.
    // you can come back and make a method safer, faster, better
    void bark() {
        if (size &gt; 60) { 
            System.out.println(“Wooof! Wooof!”); 
        } else if (size &gt; 14) {
            System.out.println(“Ruff! Ruff!”); } 
        else {
            System.out.println(“Yip! Yip!”); 
        }
    }
}
</code></pre>

<h3 id="toc_13">4.4 Instance variables</h3>

<p>You don&#39;t have to initialize instance variables, because they always have a default value:</p>

<ul>
<li>intergers: 0</li>
<li>floating points: 0.0</li>
<li>booleans: false</li>
<li>references: null</li>
</ul>

<h3 id="toc_14">4.5 Instance and local variables</h3>

<p>The difference between instance and local variables:</p>

<ul>
<li><strong>Instance</strong> variables are declared <u>inside a class</u> but not within a method.</li>
<li><strong>Local</strong> variables are declares <u>within a method</u> .</li>
<li><strong>Local</strong> variables <u>must be initialized</u> before use.</li>
</ul>

<h3 id="toc_15">4.6 Comparing variables</h3>

<p>If you want to know if two objects are <strong>equal</strong>, you need the <code>.equal()</code> method.</p>

<ul>
<li>whether two different objects should be treated as equal depends on what makes sense for that particular object type. (e.g. dog/string)</li>
</ul>

<pre><code class="language-java">String S = &quot;baby&quot;;
S.equal(another_string);
</code></pre>

<p>To see if two reference are the same (which means they refer to the same object on the heap) use the <code>==</code> operator.</p>

<pre><code class="language-text">Foo a = new Foo(); 
Foo b = new Foo(); 
Foo c = a; 
if (a == b) { // false } 
if (a == c) { // true } 
if (b == c) { // false }
</code></pre>

<p>To compare two primitives, use the <code>==</code> operator.</p>

<ul>
<li>Operator <code>==</code> doesn&#39;t care about the size of the variable, so all the extra zeros on the left end don&#39;t matter.</li>
</ul>

<pre><code class="language-java">int a = 3;
byte b = 3;
if (a==b){ //true}
</code></pre>

<h2 id="toc_16">5 Writing a Program</h2>

<ul>
<li><strong>prep code</strong>: a form of pseudocode, to help you focus on the logic without stressing about syntax. 一种伪代码</li>
<li><strong>test code</strong>: a class or methods that will test the real code and validate that it&#39;s doing the right thing. 测试代码</li>
<li><strong>real code</strong>: the actual implementation of the class. 真实代码</li>
</ul>

<p><strong>Extreme Programming</strong>（<a href="https://en.wikipedia.org/wiki/Extreme_programming">极限编程</a>):</p>

<ul>
<li>Write the test code first</li>
<li>Make small, but frequent, releases</li>
<li>Develop in iteration cycles.</li>
</ul>

<h2 id="toc_17">6  Get to know the Java API</h2>

<p><code>ArrayList</code> is a class in the core Java library (the API).</p>

<ul>
<li> <code>boolean add(Object elem)</code>: Adds the objects parameter to the list(return <code>true</code>).</li>
<li> <code>boolean remove(int index)</code>: Removes the object at the index parameter. Returns <code>true</code> if the element was in the list.</li>
<li> <code>boolean remove(Object elem)</code>: Removes this object(if it&#39;s in the ArrayList).</li>
<li> <code>boolean contains(Object elem)</code>: Returns <code>true</code> if there&#39;s a match for the object parameter.</li>
<li> <code>boolean isEmpty()</code>: Returns <code>true</code> if the list has no elements</li>
<li> <code>int indexOf(Object elem)</code>: Returns either the index of the object parameter, or -1</li>
<li> <code>size()</code>: Return the number of elements currently in the list.</li>
<li> <code>Object get(int index)</code>: Return the object currently at the index parameter.</li>
</ul>

<p>You have to know the full name of the class you want to use in your code. You have two options:</p>

<ul>
<li>Import: put an import statement at the top of your source code file:
<ul>
<li><code>import java.util.ArrayList</code></li>
</ul></li>
<li>Type: type the full name everywhere in your code. Each time you use it.
<ul>
<li><code>java.util.ArrayList&lt;Dog&gt; list = new java.util.ArrayList&lt;Dog&gt;();</code></li>
</ul></li>
</ul>

<h2 id="toc_18">7 Inheritance and polymorphism</h2>

<h3 id="toc_19">7.1 overriding</h3>

<p><strong>Overriding</strong>（重写) just means that a subclass redefines one of its inherited methods when it needs to change or extend the behavior of that method.</p>

<p>When one class inherits from another, the subclass inherits from the superclass. In Java, we say that the <strong>subclass extends the superclass</strong>.子类继承自父类。</p>

<p>Instance variables are not overridden because they don&#39;t need to be. They don&#39;t define any special behavior, so a subclass can give an inherited instance variable any value it chooses.实例变量无法被覆盖掉是因为不需要，它们并没有定义特殊的行为。</p>

<p>When you want to know if one thing should extend another, apply the IS-A test.若你想要知道某物是否应该要继承另一物时，则可以用IS-A(是一个)测试来检验。</p>

<p><strong>If class B extends class A, class B IS-A class A.</strong>   如果类B继承类A，那么类B是一个类A。</p>

<p>if your subclass overriding method, you can call the superclass version using the keyword <strong>super</strong>.</p>

<pre><code class="language-java">// this calls the inherited version on roam(),
// then comes back to do your own subclass-specific code
public void roam(){
    super.roam();
    //my own roam stuff
}
</code></pre>

<p>There are four access levels, moving from most restrictive to least, the four access levels are: 四种权限，左边是最受限制的，而越往右边限制程度越小：</p>

<p><strong>prive, default, protected, public</strong></p>

<ul>
<li>public members are inherited. public类型的成员会被继承</li>
<li>private members are not inherited. private类型的成员不会被继承</li>
</ul>

<p>Inheritances lets you guarantee that all classes grouped under a certain supertype have all the methods that the supertype has. In other words, you define a common protocol for a set of classes related through inheritance. 继承让你可以确保某个父类型之下的所有类都会有父类型所持有的全部方法。也就是说，你会通过继承来定义相关类间的共同协议。</p>

<p>when you define a supertype for a group of classes, any subclass of that supertype can be substituted where the supertype is expected.<br/>
当你定义出一组类的父型时，你可以用子型的任何类来填补任何需要或期待父型的位置。</p>

<h3 id="toc_20">7.2 Polymorphism</h3>

<p><strong>With polymorphism, the reference type can be a superclass of the actual object type</strong>. 运用多态时，引用类型可以是实际对象类型的父类。</p>

<pre><code class="language-java">Animal[] animals = new Animal[3];
animals [0] = new Dog();
animals [1] = new Cat();
animals [2] = new Lion();
for (int i=0; i&lt; animals.length; i++) {
    animals[i].eat();
    animals[i].roam();
}
</code></pre>

<p>You can have polymorphic arguments and return types. 参数和返回类型也可以多态。</p>

<pre><code class="language-java">class Vet {
    public void giveShot(Animal a) { 
    // do horrible things to the Animal at 
    // the other end of the ‘a’ parameter 
    a.makeNoise(); 
    }
}

class PetOwner {
    public void start() { 
        Vet v = new Vet(); 
        Dog d = new Dog(); 
        Hippo h = new Hippo(); 
        v.giveShot(d); 
        v.giveShot(h);
}
</code></pre>

<p>If I write my code using polymorphic arguments, where I declare the method parameter as a superclass type, I can pass in any subclass object at runtime. 如果我将程序代码编写使用多态参数，也就是说将参数声明为父类类型，我就可以在运行时传入任何的子类对象。</p>

<p>With polymorphism, you can write code that doesn&#39;t have to change when you introduce new subclass types into the program. 通过多态，你就可以编写出引进新型子类时也不必修改的程序。</p>

<p>There are three things that can prevent a class from being subclassed.</p>

<ul>
<li>A class can be non-public (if you don&#39;t declare the class as public. A non-public class can be subclassed only by classes in the same package as the class. 类可以是非公有的，非公有的类只能被同一个包的类作出子类。</li>
<li>Using keyword modifier <code>final</code> to stop  a class from being subclassed. 使用<code>final</code>修饰符阻止类被继承。</li>
<li>If a class has only <code>private</code> constructors, it can&#39;t be subclassed. 如果类只拥有<code>private</code>的构造程序，它不能被继承。</li>
</ul>

<p>If you want to protect a specific method from being overridden, mark the method with the <code>final</code> modifier. 如果你想要防止特定的方法被覆盖，可以将该方法标识成final表示没有任何的方法可以被覆盖。</p>

<p><strong>Rules for overriding</strong>:</p>

<ul>
<li>Arguments must be the same, and return types must be compatible. 参数必须要一样，且返回类型必须要兼容</li>
<li>The method can&#39;t be less accessible. 不能降低方法的访问权限</li>
</ul>

<h3 id="toc_21">7.3 Method overloading</h3>

<p><strong>Method overloading</strong>(方法重载) is nothing more than having two methods with the same name but different argument lists. 方法重载就是方法名称相同，但参数列表不同。 </p>

<ul>
<li>Purpose: overloading lets you make multiple versions of a method, with different argument lists, for convenience to the callers.  重载可以有同一方法的多个不同参数列表的版本，方便了调用者。</li>
<li>The return types can be different 返回类型可以不同</li>
<li>You can&#39;t change only the return type 不能只改变返回类型</li>
<li>You can vary the access levels in any direction 可以更改访问权限</li>
</ul>

<h2 id="toc_22">8 Interfaces and abstract classes</h2>

<p>What&#39;s an interface? it&#39;s a 100% abstract class. <br/>
What&#39;s an abstract class? it&#39;s a class that can&#39;t be instantiated.</p>

<h3 id="toc_23">Abstract classes</h3>

<p>Here&#39;s where it gets weird:</p>

<pre><code class="language-text">Animal anim = new Animal(); 
</code></pre>

<p>There two are the same type, but what the heck does an Animal object look like?</p>

<p><strong>Some classes just should not be instantiated!</strong><br/>
How?  By marking the class as <strong>abstract</strong>, the compiler will stop any code, anywhere, from ever creating an instance of that type. i.e. prevent a class from ever being instantiated.</p>

<p>Making a class abstract before the class declaration:</p>

<pre><code class="language-java">abstract class Caine extends Animal {
    public void roam() {}
}
</code></pre>

<p>When you&#39;re designing your class inheritance structure, you have to decide which classes are <em>abstract</em> and which are <em>concrete</em>. </p>

<ul>
<li><strong>Concrete</strong> classes are those that are specific enough to be instantiated. </li>
<li>A <strong>concrete</strong> class just means that it&#39;s OK to make objects of that type.</li>
<li>An <strong>abstract class</strong> has virtually no use, no value, no purpose in life, unless it is extended.</li>
</ul>

<h3 id="toc_24">Abstract methods</h3>

<p>An <strong>abstract method</strong> means the method must be overriden, whereas an abstract class means the class must be extended.</p>

<ul>
<li>there isn&#39;t any code that would make sense in the abstract method, you won&#39;t put in a method body. e.g. <code>public abstract void eat()</code>.</li>
<li>If you declare an abstract method, you must mark the class abstract as well. You can&#39;t have an abstract method in a non-abstract class.</li>
<li>You must implement all abstract methods.</li>
</ul>

<h3 id="toc_25">the ultimate superclass: Object</h3>

<p>Every class in Java extends class Object. Class Object is the mother of all classes; it&#39;s the superclass of everything. Java中的每个类都是从Object这个类继承出来的。Object类是所有类的妈妈，他是所有类的父类。</p>

<ul>
<li>Any class that doesn&#39;t <em>explicitly</em> extend another class, <em>implicitly</em> extends Object.</li>
</ul>

<p>Methods of Object class:</p>

<ul>
<li><code>equals()</code>: tell you if two objects are considered equal.</li>
<li><code>getClass()</code>: Gives you back the class that object was instantiated from.</li>
<li><code>hashCode()</code>: Prints out a hashcode for the object</li>
<li><code>toString()</code>: Prints out a String message with the name of the class and some other number we rarely care about.</li>
</ul>

<p>Object is a <strong>non-abstract</strong> class because it&#39;s got method implementation code that all classes can inherit and use out-of-box, without having to override the methods.</p>

<p>The Object class serves two main purpose:</p>

<ul>
<li>to act as a polymorphic type for methods that need to work on any class that you or anyone else makes 作为方法的多态类型</li>
<li>to provide real method code that all objects in Java need at runtime (and putting them in class Object means all other classes inherit them).提供Java在执行期堆任何对象都有需要的实现方法代码。</li>
</ul>

<h3 id="toc_26">Using polymorphic references of type Object has a price</h3>

<p>When you put an object into an <code>ArrayList&lt;Dog&gt;</code>, it goes in as a Dog, and coms out as a Dog:</p>

<pre><code class="language-java">// Make an ArrayList declared to hold Dog objects.
ArrayList&lt;Dog&gt; myDogArrayList = new ArrayList&lt;Dog&gt;();
// Make a Dog
Dog aDog = new Dog();
// Add the Dog to the list
myDogArrayList.add(aDog);
//Assign the Dog from the list to a new Dog reference variable
Dog d = myDogArrayList.get(0);
</code></pre>

<p><strong>Everything comes out of an <code>ArrayList&lt;Object&gt;</code> as a reference of type Object, regardless of what the actual object is.</strong> 任何从<code>ArrayList&lt;Object&gt;</code>取出的东西都会被当作Object类型的引用，而不管它原来是什么。</p>

<pre><code class="language-java">// make an ArrayList declared to hold any type of Object
ArrayList&lt;Object&gt; myDogArrayList = new ArrayList&lt;object&gt;()
// make a Dog
Dog aDog = new Dog();
// Add the Dog to the list
myDogArrayList.add(aDog);
// No!! Won&#39;t compile!! the get() method returns type Object.
// The compiler knows only that the object inherits from Object,
// but it doesn&#39;t know it&#39;s a Dog!!
Dog d = myDogArrayList.get(0)
</code></pre>

<p><strong>The compiler decides whether you can call a method based on the reference type, not the actual object type.</strong>:</p>

<pre><code class="language-java">Object o = al.get(index);
// Class Object has a hashCode() method
// so you can call that method on any object in Java
int i = o.hashCode();
// Can&#39;t do this!! the Object class  has no idea what it means to bark().
o.bark();
</code></pre>

<p><img src="media/15321391987415/method%20based%20on%20the%20reference%20type.png" alt="method based on the reference type"/></p>

<p>If you&#39;re sure the object is really a Dog, you can make a new Dog reference to it by copying the Object reference, and forcing that copy to go into a Dog reference variable, using a cast (Dog).</p>

<pre><code class="language-java">Object o = al.get(index);
// cast the Object back to a Dog we know is there.
Dog d = (Dog) o;
d.roam();
</code></pre>

<p>If you&#39;re not sure it&#39;s a Dog, you can use the <code>instanceof</code> operator to check.</p>

<pre><code class="language-java">if (o instanceof Dog) {
    Dog d = (Dog) o;
}
</code></pre>

<h3 id="toc_27">Interface</h3>

<p>Questions: what if you want to add Dog some Pet behaviors?</p>

<ul>
<li><p>Option one: We take the easy path, and put pet method in class Animal.</p>
<ul>
<li>Pros: All the Animals will instantly inherit the pet behaviors. We won&#39;t have to touch the existing Animal subclasses at all.</li>
<li>Cons: Some animals like lion, wolf are not a pet. Non-pet Animals running around with pet methods.</li>
</ul></li>
<li><p>Option two: We start with option one, putting the pet methods in class Animal, but we make the methods abstract.</p>
<ul>
<li>Pros: All classes must override the methods, but they can make the methods &quot;do-nothings&quot;.</li>
<li>Cons: Waste a lot of time to implement every concrete Animal subclasses.</li>
</ul></li>
<li><p>Options three: Put the pet methods Only in the classes where they belong.</p>
<ul>
<li>Pros: The methods are where they belong, and only where they belong.</li>
<li>Cons: Firstly, you&#39;d have to agree to a protocol, and all programmers of pet Animal classes now and in the future would have to know about the protocol. Secondly, you don&#39;t get to use polymorphism for the pet methods </li>
</ul></li>
</ul>

<p>It looks like we need two superclasses at the top.<br/>
<img src="media/15321391987415/it%20looks%20like%20we%20need%20two%20superclasses%20at%20the%20top.png" alt="it looks like we need two superclasses at the top"/></p>

<p>It’s called &quot;<strong>multiple inheritance</strong>&quot;(多重继承) and it can be a Really Bad Thing. Because multiple inheritance has a problem known as <strong>The Deadly Diamond of Death</strong>(致命的死亡砖石)</p>

<p><img src="media/15321391987415/deadly_diamond_of_death.png" alt="deadly_diamond_of_death"/></p>

<p>Java的方案: Interface!!!</p>

<ul>
<li>A Java <strong>interface</strong>(接口) solves multiple inheritance problem by giving you much of the polymorphic benefits of multiple inheritance without the pain and suffering from the Deadly Diamond of Death.</li>
</ul>

<p>How?</p>

<ul>
<li>surprisingly simple: <strong><em>make all the methods abstract</em></strong></li>
<li>A Java interface is like a 100% pure abstract class.</li>
</ul>

<p>To define an interface:</p>

<pre><code class="language-java">//use the keyword &quot;interface&quot; instead of &quot;class&quot;
public interface Pet {}
</code></pre>

<p>To implement an interface:</p>

<pre><code class="language-java">// Use the keyword &quot;implements&quot; followed by the interface name.
public class Dog extends Canine implements Pet {}
</code></pre>

<p>A class can implement <em>multiple</em> interfaces!</p>

<pre><code class="language-java">public class Dog extends Animal implements Pet, Saveable, Paintable {}
</code></pre>

<p>Classes from <em>different</em> inheritance trees can implement the <em>same</em> interface.</p>

<p><img src="media/15321391987415/Classes%20from%20different%20inheritance%20trees%20can%20implement%20the%20same%20interface..png" alt="Classes from different inheritance trees can implement the same interface."/></p>

<p>How do you know whether to make a class, subclass, an abstract class, or an interface?</p>

<ul>
<li>Make a class that doesn’t extend anything (other than Object) when your new class doesn’t pass the IS-A test for any other type.</li>
<li>Make a subclass (in other words, extend a class) only when you need to make a <strong><em>more specific</em></strong> version of a class and need to override or add new behaviors.</li>
<li>Use an abstract class when you want to define a <strong><em>template</em></strong> for a group of subclasses, and you have at least some implementation code that all subclasses could use. Make the class abstract when you want to guarantee that nobody can make objects of that type.</li>
<li>Use an interface when you want to define a <strong><em>role</em></strong> that other classes can play, regardless of where those classes are in the inheritance tree.</li>
</ul>

<h3 id="toc_28">Using <code>super</code></h3>

<p>What if you don&#39;t want to <em>replace</em> the method with an override in a concrete subclass, but you just want to <em>add</em> to it with some additional specific code?</p>

<pre><code class="language-java">abstract class Report { 
    void runReport() { 
        // set-up report 
    } 
    void printReport() { 
    // generic printing 
    } 
}

class BuzzwordsReport extends Report {
    void runReport() {
        // call superclass version, then come back and do some      
        // subclass-specific stuff
        super.runReport();
        buzzwordCompliance(); 
        printReport();
    }
    void buzzwordCompliance() {...}
}
</code></pre>

<p><img src="media/15321391987415/usage%20of%20Super.png" alt="usage of Supe"/></p>

<h2 id="toc_29">9 Constructors and garbage collection</h2>

<h2 id="toc_30">10 Numbers and statics</h2>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2018/4/21</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='programming_language.html'>编程语言</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15323640524161.html">
                
                  <h1>Machine Learning with large datasets</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h2 id="toc_0">1 overview</h2>

<p>Why use big data?</p>

<ul>
<li>Simple learning methods with large data sets can outperform complex learners with smaller datasets</li>
<li>The ordering of learning methods, best-to-worst, can be different for small datasets than from large datasets</li>
<li>The best way to improve performance for a learning system is often to collect more data</li>
<li>Large datasets often imply large classifiers</li>
</ul>

<p>Asymptotic analysis</p>

<ul>
<li>It measures number of operations as function of problem size</li>
<li>Different operations (eg disk seeking, scanning, memory access) can have very very different costs</li>
<li>Disk access is cheapest when you scan sequentially</li>
</ul>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2018/7/24</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='Computer%20System.html'>Computer System</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="os_concepts_threads_and_concurrency.html">
                
                  <h1>Operating System Concepts 4 - Threads & Concurrency</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<ul>
<li>
<a href="#toc_0">1 Overview</a>
<ul>
<li>
<a href="#toc_1">1.1 Motivation</a>
</li>
<li>
<a href="#toc_2">1.2 Benefits</a>
</li>
</ul>
</li>
<li>
<a href="#toc_3">2 Multicore Programming</a>
<ul>
<li>
<a href="#toc_4">2.1 Programming Challenges</a>
</li>
<li>
<a href="#toc_5">2.2 Types of Parallelism</a>
</li>
</ul>
</li>
<li>
<a href="#toc_6">3 Multithreading Models</a>
<ul>
<li>
<a href="#toc_7">3.1 Many-to-One Model</a>
</li>
<li>
<a href="#toc_8">3.2 One-to-One Model</a>
</li>
<li>
<a href="#toc_9">3.3 Many-to-Many Model</a>
</li>
<li>
<a href="#toc_10">3.4 User/Kernel-Level threads</a>
</li>
</ul>
</li>
<li>
<a href="#toc_11">4 Thread Libraries</a>
</li>
<li>
<a href="#toc_12">5 Implicit threading</a>
<ul>
<li>
<a href="#toc_13">5.1 Thread Pools</a>
</li>
<li>
<a href="#toc_14">5.4 Grand Central Dispatch</a>
</li>
</ul>
</li>
<li>
<a href="#toc_15">6 Threading Issues</a>
<ul>
<li>
<a href="#toc_16">6.1 Light Weight Process</a>
</li>
<li>
<a href="#toc_17">6.2 Scheduler activation</a>
</li>
</ul>
</li>
</ul>


<h2 id="toc_0">1 Overview</h2>

<p>A <strong>thread</strong> is a basic unit of CPU utilization; it comprises a thread ID, a program counter, a register set, and a stack.</p>

<p>线程是一个CPU利用的基本单元，它由线程ID，程序计数器、寄存器集合和栈组成。</p>

<p>A traditional process has a single thread of control. If a process has <strong>multiple threads of control</strong>, it can perform more than one task at a time. <br/>
一个传统的进程只有单个控制线程，如果进程有多个控制线程，那么它能一次处理多个任务。</p>

<p>The figure below illustrates the difference between a traditional <strong>single-threaded</strong> process and a <strong>multithreaded</strong> process.</p>

<p><img src="media/15319932561412/single%20threaded%20and%20multithreaded%20processes.png" alt="single threaded and multithreaded processes"/></p>

<h3 id="toc_1">1.1 Motivation</h3>

<p>Process creation is <strong>time consuming</strong> and <strong>resource intensive</strong>. It is generally more efficient to use one process that contains multiple threads.</p>

<h3 id="toc_2">1.2 Benefits</h3>

<p>The benefits of  multithreaded programming can be broken down into four major categories:</p>

<ol>
<li><p><strong>Responsiveness</strong></p>
<ul>
<li>It allows a program to continue running even if part of it is blocked or is performing a lengthy operation, thereby increasing responsiveness to the user.</li>
<li>响应度高：即使程序部分阻塞或执行较冗长操作，该程序仍能继续执行，从而增加了对用户的相应程度。</li>
</ul></li>
<li><p><strong>Resource sharing</strong></p>
<ul>
<li>Processes can share resources only through techniques such as shared memory and message. Such techniques must be explicitly arranged by the programmer.</li>
<li>Threads share the memory and the resources of the process to which they belong by default.</li>
<li>资源共享：线程默认共享它们所属进程的内存和资源。代码和数据共享的优点是它允许一个应用程序在同一地址空间有多个不同的活动线程。</li>
</ul></li>
<li><p><strong>Economy</strong></p>
<ul>
<li>Allocating memory and resources for process creation is costly. Because threads share the resources of the process to which they belong, it is more economical to create and context-switch threads.</li>
<li>经济：进程创建所需要的内存和资源的分配比较昂贵。由于线程能共享它们所属进程的资源，所以创建和切换线程会更为经济。</li>
</ul></li>
<li><p><strong>Scalability</strong></p>
<ul>
<li>The benefits of multithreading can be even greater in a multiprocessor architecture, where threads may be running in parallel on different processing cores.</li>
<li>可扩展性: 多线程的优点之一是能充分使用多处理器体系结构。以便每个进程能并行运行在不同的处理器上。</li>
</ul></li>
</ol>

<h2 id="toc_3">2 Multicore Programming</h2>

<p>On a system with a <strong>single</strong> computing core, concurrency merely means that the execution of the threads will be <strong>interleaved</strong> over time, because the processing core is capable of executing only one thread at a time.</p>

<p>On a system with <strong>multiple</strong> cores, however, concurrency means that some threads can run in <strong>parallel</strong>, because the system can assign a separate thread to each core.</p>

<p><img src="media/15319932561412/concurrency%20of%20single%20and%20multiple%20core.png" alt="concurrency of single and multiple core"/></p>

<p>Note: <strong><em>Concurrency</em></strong> v.s. <strong><em>Parallelism</em></strong></p>

<ul>
<li>Concurrency: supports more than one task by allowing all the tasks to make progress.</li>
<li>Parallelism: perform more than one task simultaneously.</li>
</ul>

<h3 id="toc_4">2.1 Programming Challenges</h3>

<ol>
<li><strong>Identifying tasks</strong>. This involves examining applications to find areas that can be divided into separate, concurrent tasks.</li>
<li><strong>Balance</strong>. Programmer must ensure that the tasks perform equal work of equal value.</li>
<li><strong>Data splitting</strong>. The data accessed and manipulated by the tasks must be divided to run on separate cores.</li>
<li><strong>Data dependency</strong>. The data accessed by the tasks must be examined for dependencies between two or more tasks.</li>
<li><strong>Testing and debugging</strong>. Testing and debugging such concurrent programs is inherently more difficult than testing and debugging single-threaded applications.</li>
</ol>

<h3 id="toc_5">2.2 Types of Parallelism</h3>

<p>In general, there are two types of parallelism: data parallelism and task parallelism.</p>

<ul>
<li><strong>Data parallelism</strong> focuses on distributing subsets of the same data across multiple computing cores and performing the same operation on each core. </li>
<li><strong>Task parallelism</strong> involves distributing not data but tasks (threads) across multiple computing cores.</li>
<li>However, data and task parallelism are not mutually exclusive, and an application may in fact use a hybrid of these two strategies.</li>
</ul>

<p>Data and task parallelism<br/>
<img src="media/15319932561412/data%20and%20task%20parallellism.png" alt="data and task parallelism"/></p>

<h2 id="toc_6">3 Multithreading Models</h2>

<p>Support for threads may be provided either at the user level, for <strong><em>user threads</em></strong>, or by the kernel, for <strong><em>kernel threads</em></strong>. </p>

<ul>
<li>User threads are supported above the kernel and are managed without kernel support.</li>
<li>Kernel threads are supported and managed directly by the operating system.</li>
</ul>

<p>有两种不同的方法来提供线程支持：用户层的用户级线程和内核层的内核级线程。用户级线程受内核支持，而无需内核管理；而内核级线程由操作系统直接支持和管理。事实上所有当代操作系统都支持内核级线程。</p>

<p>Ultimately, a relationship must exist between user threads and kernel threads. There are three common ways of establishing such a relationship: the many-to-one model, the one-to-one model, and the many-to-many model.<br/>
在用户级线程和内核级线程之间必然存在一种关系。有三种普遍建立这种关系的方法：多对一模型、一对一模型、多对多模型。</p>

<h3 id="toc_7">3.1 Many-to-One Model</h3>

<p>The <strong><u>many-to-one model</u></strong> maps many user-level threads to one kernel thread. 多对一模型将许多用户级线程映射到一个内核线程。</p>

<ul>
<li>Thread management is done by the thread library in user space, so it is efficient. 线程管理由线程库在用户空间进行的，因而效率比较高。</li>
<li>Also, because only one thread can access the kernel at a time, multiple threads are unable to run in parallel on multicore systems. 因为任意时刻只能有一个线程能够访问内核，多个线程不能并行运行在多处理器上。</li>
</ul>

<p><img src="media/15319932561412/many_to_one_model.png" alt="many_to_one_mode"/></p>

<h3 id="toc_8">3.2 One-to-One Model</h3>

<p>The <strong>one-to-one model</strong> maps each user thread to a kernel thread. 一对一模型每个用户线程映射到一个内核线程。</p>

<ul>
<li>It provides more concurrency by allowing another thread to run when a thread makes a blocking system call. 该模型在一个线程执行阻塞系统调用时，能允许另一个线程继续执行，提供了更高的并发性。</li>
<li>It also allows multiple threads to run in parallel on multiprocessors. 它也允许多个线程能并行运行在多处理器系统上。</li>
<li>The only drawback to this model is that creating a user thread requires creating the corresponding kernel thread, and a large number of kernel threads may burden the performance of a system. 这种模型的唯一缺点是每创建一个用户线程就会创建一个相应的内核线程, 大量内核线程会影响系统性能。</li>
</ul>

<p><img src="media/15319932561412/one_to_one_model.png" alt="one_to_one_mode"/></p>

<h3 id="toc_9">3.3 Many-to-Many Model</h3>

<p>The <strong>many-to-many model</strong> multiplexes many user-level threads to a smaller or equal number of kernel threads. 多对多模型多路复用了许多用户线程到同样数量或更小数量的内核线程上。</p>

<ul>
<li>Developers can create as many user threads as necessary. 开发人员可创建任意多的用户线程。</li>
<li>The corresponding kernel threads can run in parallel on a multiprocessor. 相应内核线程能在多处理器系统上并发执行。</li>
<li>Also, when a thread performs a blocking system call, the kernel can schedule another thread for execution. 而且当一个线程执行阻塞系统调用时，内核能调度另一个线程来执行。</li>
<li>In practice it is <strong>difficult to implement</strong>. 实际上难以实施。</li>
</ul>

<p><img src="media/15319932561412/many_to_many_model.png" alt="many_to_many_mode"/></p>

<p><u><strong><em>Most operating systems now use the one-to-one model.</em></strong></u></p>

<h3 id="toc_10">3.4 User/Kernel-Level threads</h3>

<p><a href="https://cs.nyu.edu/rgrimm/teaching/sp07-os/activations.pdf">ref: Scheduler Activations</a></p>

<p>(1) <strong>User-Level Threads</strong>(用户级线程)</p>

<p>Advantages</p>

<ul>
<li>Common operations can be implemented <strong>efficiently</strong> </li>
<li>Interface can be tailored to application needs</li>
</ul>

<p>Issues:</p>

<ul>
<li>A blocking system call blocks all user-level threads. 阻塞系统调用能够阻塞所有用户级线程。</li>
<li>Asynchronous system calls can provide partial work-around. 非同步系统调用能提供部分work-around. <a href="https://en.wikipedia.org/wiki/Workaround">view the definition of work-around here</a></li>
<li>A page fault blocks all user-level threads. 缺页异常阻塞所有用户级线程。</li>
<li>Matching threads to CPUs in a multiprocessor is hard：
<ul>
<li>No knowledge about the numbers of CPUs available to address space </li>
<li>No knowledge when a thread blocks</li>
</ul></li>
</ul>

<p>(2) <strong>Kernel-Level Threads</strong> (内核级线程)</p>

<p>Primary advantage</p>

<ul>
<li>Blocking system calls and page faults handled correctly</li>
</ul>

<p>Issues</p>

<ul>
<li>Cost of performing thread operations</li>
<li>Create, exit, lock, signal, wait all require user/kernel crossings</li>
</ul>

<p><strong>NOTE</strong>: The term <strong><u>virtual processor</u></strong> is often used instead of kernel thread.</p>

<h2 id="toc_11">4 Thread Libraries</h2>

<p>A thread library provides the programmer with an API for creating and managing threads. 线程库为程序员提供了创建和管理线程的API。</p>

<p><strong>Pthreads</strong>, the threads extension of the POSIX standard, may be provided as either a user-level or a kernel-level library. Pthread作为POSIX标准扩展，可以提供用户级或内核级的库。</p>

<ul>
<li><code>pthread_t tid</code>: declares the identifier for the thread</li>
<li><code>pthread attr_t attr</code>: declares the attributes for the thread</li>
<li><code>pthread_attr_init(&amp;attr)</code>: initialize thread attributes object</li>
<li><code>pthread_create()</code>: create a new thread</li>
<li><code>pthread_join()</code>:  join with a terminated thread<br/></li>
<li><code>pthread_exit()</code>:  terminate calling thread<br/></li>
</ul>

<p>Note: Compile and link with <code>-pthread</code>.</p>

<p><code>pthread</code>详细用法和实例, 见<a href="https://www.cs.cmu.edu/afs/cs/academic/class/15492-f07/www/pthreads.html">POSIX thread (pthread) libraries</a></p>

<h2 id="toc_12">5 Implicit threading</h2>

<p><strong>Implicit threading</strong>(隐式线程): Transfers the creation and management of threading from application developers to compilers and run-time libraries.</p>

<ul>
<li>One way to address difficulties and better support the design of concurrent and parallel applications</li>
<li>The advantage of this approach is that developers <strong><em><u>only need to identify parallel tasks</u></em></strong>, and the libraries determine the specific details of thread creation and management.</li>
</ul>

<p>In this section, we explore four alternative approaches to designing applications that can take advantage of multicore processors through implicit threading:</p>

<ul>
<li>Thread Pools</li>
<li>Fork Join</li>
<li>OpemMP</li>
<li>Grand Central Dispatch</li>
</ul>

<h3 id="toc_13">5.1 Thread Pools</h3>

<p>Two main issues exist:</p>

<ul>
<li>The thread will be <strong>discarded</strong> once it has completed its work. 线程在完成工作之后就要被丢弃</li>
<li><strong>Unlimited</strong> threads could exhaust system resources. 无限制的线程会耗尽系统资源</li>
</ul>

<p>Solution -&gt; <strong>thread pool</strong>(线程池)</p>

<ul>
<li>It creates a number of threads at start-up, and places them into a pool, where they sit and wait for work.</li>
<li>When a server receives a request, it submits the request to the thread pool and resumes waiting for additional requests.</li>
<li>If there is an available thread in the pool, it is awakened, and the request is serviced immediately. </li>
<li>If the pool contains no available thread, the task is queued until one becomes free. </li>
</ul>

<p>线程池的思想是在进程开始时创建一定数量的线程，并放入到池中以等待工作。当服务器收到请求时，它会唤醒线程池中的一个线程，并将要处理的请求传递给它，一旦线程完成了服务，它会返回到池中在等待工作。如果池中没有可用的线程，那么服务器会一直等待直到有空线程为止。</p>

<p>Thread pools offer these benefits:</p>

<ol>
<li>Servicing a request with an existing thread is often <strong>faster</strong> than waiting to create a thread. 通常用现有线程处理请求要比等待创建新的线程要快.</li>
<li>A thread pool <strong>limits</strong> the number of threads that exist at any one point.  线程池限制了在任何时候可用线程的数量.</li>
<li>Separating the task to be performed from the mechanics of creating the task allows us to use different strategies for running the task.</li>
</ol>

<p>Java线程库的一个例子：</p>

<pre><code class="language-java">import java.util.concurrent.*; 
public class ThreadPoolExample 
{ 
    public static void main(String[] args) {
        int numTasks = Integer.parseInt(args[0].trim()); 
        
        /* Create the thread pool */ 
        ExecutorService pool = Executors.newCachedThreadPool(); 
        /* Run each task using a thread in the pool */ 
        for (int i = 0; i &lt; numTasks; i++) 
            pool.execute(new Task()); 
        
         /* Shut down the pool once all threads have completed */            
        pool.shutdown();
}
</code></pre>

<h3 id="toc_14">5.4 Grand Central Dispatch</h3>

<p><strong>Grand Central Dispatch</strong> (GCD) is a technology for Apple&#39;s Mac OS X and iOS operating systems. It is a combination of extensions to the C languages, an API, and a run-time library that allows application developers identify sections of code to run in parallel.</p>

<ul>
<li>GCD identifies two types of dispatch queues: serial and concurrent.</li>
</ul>

<h2 id="toc_15">6 Threading Issues</h2>

<h3 id="toc_16">6.1 Light Weight Process</h3>

<p>Many systems implementing either the many-to-many or the two-level model place an <em>intermediate</em> data structure between the user and kernel threads. This data structure—typically known as a <strong><u><em>lightweight process</em></u></strong>（轻量级进程）, or <strong>LWP</strong>.</p>

<ul>
<li>To the user-thread library, the LWP appears to be a <strong>virtual</strong> processor on which the application can schedule a user thread to run.</li>
<li>Each LWP is attached to a kernel thread.</li>
<li>If a kernel thread blocks, the LWP blocks as well. Up the chain, the user-level thread attached to the LWP also blocks.</li>
</ul>

<p><img src="media/15319932561412/light-weight%20process.png" alt="light-weight process"/></p>

<p><img src="media/15319932561412/15320591793590.jpg" alt=""/></p>

<p>where K denotes kernel threads and  P denotes Process.</p>

<p>下面是一个测试LINUX中LWP的C程序</p>

<pre><code class="language-c">/* filename: test_LWP.c */
#include &lt;stdlib.h&gt;
#include &lt;pthread.h&gt;
#include &lt;stdio.h&gt;
#include &lt;unistd.h&gt;

int* thread(void* arg)
{
    pthread_t tid; // the ID of a thread
    tid = pthread_self();//get the current thread&#39;s id
 
    printf(&quot;The ID of new thread is =%lu\n&quot;, tid);
    sleep(500); //sleep for 500 seconds
    return NULL; 
}
  
int main()
{
    pthread_t tid;
    printf(&quot;The ID of main thread is %lu\n&quot;, pthread_self()); //get the main thread&#39;s id
  if (pthread_create(&amp;tid, NULL, (void *) thread, NULL) !=0) 
    {
       printf(&quot;Thread creation failed\n&quot;);
        exit(1);
    }
      
    printf(&quot;my Id is %lu, new thread ID is %lu\n&quot;, pthread_self(), tid);
    sleep(1000);
    return 0;
}
</code></pre>

<p>运行<code>ps -efL</code> 可以看到, <code>test_LWP</code>进程(PID=1953)有两个LWP，即NLWP(number of light weight process)=2。</p>

<pre><code class="language-text">UID        PID  PPID   LWP  C NLWP STIME TTY          TIME CMD
vagrant   1953  1644  1953  0    2 04:16 pts/0    00:00:00 ./test_LWP
vagrant   1953  1644  1954  0    2 04:16 pts/0    00:00:00 ./test_LWP
vagrant   2028  1839  2028  0    1 04:18 pts/1    00:00:00 ps -efL
</code></pre>

<h3 id="toc_17">6.2 Scheduler activation</h3>

<p><strong>Problems</strong>:<br/>
内核线程在各方面都比较灵活，但是性能不高，经常会出现请求在用户空间和内核空间的传递。那么如何在拥有内核空间线程的灵活性的同时又提高性能呢?</p>

<p><strong>Solution</strong>:</p>

<p><strong>Scheduler activation</strong>（调度器激活）are a threading mechanism that, when implemented in an operating system&#39;s process scheduler, provide <em><u>kernel-level</u></em> thread functionality with <u><em>user-level</em></u> thread flexibility and performance [<a href="https://en.wikipedia.org/wiki/Scheduler_activations">ref</a>]. </p>

<p>It works as follows: </p>

<ul>
<li>The kernel provides an application with a set of virtual processors (LWPs), and the application can <strong>schedule</strong> user threads onto an available virtual processor. </li>
<li>Furthermore, the kernel must inform an application about certain events. This procedure is known as an <strong>upcall</strong>(向上调用). </li>
<li>Upcalls are handled by the thread library with an upcall handler, and upcall handlers must run on a virtual processor.</li>
<li>While the user threading library will schedule user threads, the kernel will schedule the underlying LWPs.</li>
</ul>

<p><strong>Example</strong> [<a href="http://www.it.uu.se/education/course/homepage/os/vt18/module-4/implementing-threads/">ref</a>]: </p>

<p>Let’s study an example of how scheduler activations can be used. The kernel has allocated one kernel thread (1) to a process with three user-level threads (2). The three user level threads take turn executing on the single kernel-level thread.</p>

<p><img src="media/15319932561412/scheduler-activations-1-2.png" alt="scheduler-activations-1-2"/></p>

<ul>
<li>(3) The executing thread makes a <strong>blocking system call</strong>.</li>
<li>(4) And the the kernel blocks the calling user-level thread and the kernel-level thread used to execute the user-level thread .</li>
<li>(5) Scheduler activation: the kernel decides to allocate a new kernel-level thread to the process . </li>
<li>(6) Upcall: the kernel notifies the user-level thread manager which user-level thread that is now blocked and that a new kernel-level thread is available. </li>
<li>(7) The user-level thread manager move the other threads to the new kernel thread and resumes one of the ready threads.</li>
</ul>

<p><img src="media/15319932561412/scheduler-activations-3-7.png" alt="scheduler-activations-3-7"/></p>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2018/2/19</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='Computer%20System.html'>Computer System</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
              


			<div class="row">
			  <div class="large-6 columns">
			  <p class="text-left" style="padding-top:25px;">
			   <a href="all.html">&laquo; Prev Page</a>  
			  </p>
			  </div>
			  <div class="large-6 columns">
			<p class="text-right" style="padding-top:25px;">
			 <a href="all_2.html">&raquo; Next Page</a> 
			</p>
			  </div>
			</div>
		</div>
	</div><!-- large 8 -->

 <div class="large-4 medium-4 columns">
  <div class="hide-for-small">
    <div id="sidebar" class="sidebar">
          <div id="site-info" class="site-info">
            
                <div class="site-a-logo"><img src="http://or9a8nskt.bkt.clouddn.com/figure.jpeg" /></div>
            
                <h1>techlarry</h1>
                <div class="site-des">他山之石，可以攻玉</div>
                <div class="social">









<a target="_blank" class="github" target="_blank" href="https://github.com/techlarry" title="GitHub">GitHub</a>
<a target="_blank" class="email" href="mailto:wang.zhen.hua.larry@gmail.com" title="Email">Email</a>
  <a target="_blank" class="rss" href="atom.xml" title="RSS">RSS</a>
                
              	 </div>
          	</div>

             

              <div id="site-categories" class="side-item ">
                <div class="side-header">
                  <h2>Categories</h2>
                </div>
                <div class="side-content">

      	<p class="cat-list">
        
            <a href="Leetcode.html"><strong>Leetcode</strong></a>
        
            <a href="programming_language.html"><strong>编程语言</strong></a>
        
            <a href="data_structure_and_algorithm.html"><strong>数据结构和算法</strong></a>
        
            <a href="Python%E7%89%B9%E6%80%A7.html"><strong>Python特性</strong></a>
        
            <a href="%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0.html"><strong>机器学习</strong></a>
        
            <a href="Python%E7%A7%91%E5%AD%A6%E8%AE%A1%E7%AE%97%E4%B8%89%E7%BB%B4%E5%8F%AF%E8%A7%86%E5%8C%96.html"><strong>Python科学计算三维可视化</strong></a>
        
            <a href="English.html"><strong>English</strong></a>
        
            <a href="Computer%20System.html"><strong>Computer System</strong></a>
        
            <a href="Deep%20Learning.html"><strong>Deep Learning</strong></a>
        
            <a href="Linux%20%E7%B3%BB%E7%BB%9F%E7%BC%96%E7%A8%8B.html"><strong>Linux 系统编程</strong></a>
        
            <a href="%E6%95%B0%E6%8D%AE%E5%BA%93.html"><strong>数据库</strong></a>
        
            <a href="Tensorflow.html"><strong>Tensorflow</strong></a>
        
            <a href="Big%20Data.html"><strong>Big Data</strong></a>
        
            <a href="%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB.html"><strong>文献阅读</strong></a>
        
            <a href="Tools.html"><strong>Tools</strong></a>
         
        </p>


                </div>
              </div>

              <div id="site-categories" class="side-item">
                <div class="side-header">
                  <h2>Recent Posts</h2>
                </div>
                <div class="side-content">
                <ul class="posts-list">
	      
		      
			      <li class="post">
			        <a href="os_concepts_synchronization_tools.html">Operating System Concepts 6 - Synchronization Tools</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="os_concepts_synchronization_examples.html">Operating System Concepts 7 - Synchronization Examples</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="os-concets-processes.html">Operating System Concepts 3 - Processes</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="diagrammatize_TCP_IP.html">图解TCP/IP</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="csapp-internet-programming.html">CSAPP - 网络编程</a>
			      </li>
		     
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		   
		  		</ul>
                </div>
              </div>
        </div><!-- sidebar -->
      </div><!-- hide for small -->
</div><!-- large 4 -->

</div><!-- row -->

 <div class="page-bottom clearfix">
  <div class="row">
   <p class="copyright">Copyright &copy; 2015
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
Theme used <a target="_blank" href="http://github.com">GitHub CSS</a>.</p>
  </div>
</div>

        </section>
      </div>
    </div>

  
    

    <script src="asset/js/foundation.min.js"></script>
    <script>
      $(document).foundation();
      function fixSidebarHeight(){
        var w1 = $('.markdown-body').height();
          var w2 = $('#sidebar').height();
          if (w1 > w2) { $('#sidebar').height(w1); };
      }
      $(function(){
        fixSidebarHeight();
      })
      $(window).load(function(){
          fixSidebarHeight();
      });
     
    </script>

    
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({TeX: { equationNumbers: { autoNumber: "AMS" } }});</script>


  </body>
</html>
