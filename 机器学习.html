<!doctype html>
<html class="no-js" lang="en">
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?fdc936c9f5a3b72177541183cdeb8cb3";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
    
  机器学习 - techlarry
  
  </title>
  
  
  <link href="atom.xml" rel="alternate" title="techlarry" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/foundation.min.css" />
    <link rel="stylesheet" href="asset/css/docs.css" />
    <script src="asset/js/vendor/modernizr.js"></script>
    <script src="asset/js/vendor/jquery.js"></script>
  <script src="asset/highlightjs/highlight.pack.js"></script>
  <link href="asset/highlightjs/styles/github.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript">
  function before_search(){
    var searchVal = 'site:larryim.cc ' + document.getElementById('search_input').value;
    document.getElementById('search_q').value = searchVal;
    return true;
  }
</script>
  </head>
  <body class="antialiased hide-extras">
    
    <div class="marketing off-canvas-wrap" data-offcanvas>
      <div class="inner-wrap">


<nav class="top-bar docs-bar hide-for-small" data-topbar>


  <section class="top-bar-section">
  <div class="row">
      <div style="position: relative;width:100%;"><div style="position: absolute; width:100%;">
        <ul id="main-menu" class="left">
        
        <li id=""><a target="_self" href="index.html">Home</a></li>
        
        <li id=""><a target="_self" href="archives.html">Archives</a></li>
        
        <li id=""><a target="_self" href="category.html">Category</a></li>
        
        <li id=""><a target="_self" href="notebook.html">NoteBook</a></li>
        
        </ul>

        <ul class="right" id="search-wrap">
          <li>
<form target="_blank" onsubmit="return before_search();" action="http://google.com/search" method="get">
    <input type="hidden" id="search_q" name="q" value="" />
    <input tabindex="1" type="search" id="search_input"  placeholder="Search"/>
</form>
</li>
          </ul>
      </div></div>
  </div>
  </section>

</nav>

        <nav class="tab-bar show-for-small">
  <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
    <span> &nbsp; techlarry</span>
  </a>
</nav>

<aside class="left-off-canvas-menu">
      <ul class="off-canvas-list">
        
        <li><a target="_self" href="index.html">Home</a></li>
        
        <li><a target="_self" href="archives.html">Archives</a></li>
        
        <li><a target="_self" href="category.html">Category</a></li>
        
        <li><a target="_self" href="notebook.html">NoteBook</a></li>
        

    <li><label>Categories</label></li>

        
            <li><a href="Leetcode.html">Leetcode</a></li>
        
            <li><a href="C/C++.html">C/C++</a></li>
        
            <li><a href="Python%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95.html">Python数据结构与算法</a></li>
        
            <li><a href="Python%E7%89%B9%E6%80%A7.html">Python特性</a></li>
        
            <li><a href="%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0.html">机器学习</a></li>
        
            <li><a href="Python%E7%A7%91%E5%AD%A6%E8%AE%A1%E7%AE%97%E4%B8%89%E7%BB%B4%E5%8F%AF%E8%A7%86%E5%8C%96.html">Python科学计算三维可视化</a></li>
        
            <li><a href="English.html">English</a></li>
        
            <li><a href="Computer%20System.html">Computer System</a></li>
        
            <li><a href="Deep%20Learning.html">Deep Learning</a></li>
        
            <li><a href="Latex.html">Latex</a></li>
        
            <li><a href="%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html">操作系统</a></li>
        
            <li><a href="Linux%20%E7%B3%BB%E7%BB%9F%E7%BC%96%E7%A8%8B.html">Linux 系统编程</a></li>
        
            <li><a href="%E6%95%B0%E6%8D%AE%E5%BA%93.html">数据库</a></li>
        
            <li><a href="Tensorflow.html">Tensorflow</a></li>
        
            <li><a href="Big%20Data.html">Big Data</a></li>
        
            <li><a href="%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB.html">文献阅读</a></li>
         

      </ul>
    </aside>

<a class="exit-off-canvas" href="#"></a>


        <section id="main-content" role="main" class="scroll-container">
        
       

 <script type="text/javascript">
	$(function(){
		$('#menu_item_index').addClass('is_active');
	});
</script>
<div class="row">
	<div class="large-8 medium-8 columns">
		<div class="markdown-body home-categories">
		
			<div class="article">
                <a class="clearlink" href="15124807146530.html">
                
                  <h1>Covariance Matrix and its application in Spark</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<p>A <code>covariance matrix</code>(协方差矩阵, 离差矩阵) is a matrix whose element in the \(i,j\) position is the covariance between the \(i^{th}\) and \(j^{th}\) elements of a <code>random vector</code>(随机向量,多元随机变量). Each element of a random vector is a scalar <code>random variable</code>(随机变量).</p>

<p>Because the covariance of the \(i^{th}\) random variable with itself is simply that random variable&#39;s variance, each element on the principal diagonal of the covariance matrix is the variance of one of the random variables:</p>

<p>The covariance between random variables \(X, Y\):</p>

<p>\[\text{cov}(X,Y)=\text{E}[(X-E[X])(Y-E[Y])]\]</p>

<p>Then the covariance matrix \(\sum\) is the matrix whose \((i,j)\) is the covariance</p>

<p>\[\sum(i,j) =\text{cov}(X_i,X_j)=\text{E}[(X_i-E[X_i])(Y_i-E[Y_i])]\]</p>

<p>where \(X=[X_1,...,X_n]\)</p>

<h2 id="toc_0">Distributed Computing: Spark</h2>

<p>Setup: Raw data \(\mathbf{P} \in \mathbb{R}^{n \times d}\)</p>

<ul>
<li>Step 1: Zero Mean Data \(X=\text{E}(P)\)

<ul>
<li>Compute \(d\) feature means, \(m\in \mathbf{R}^d\)</li>
<li>Communication \(m\) to all workers</li>
<li>Subtract \(m\) from each data point</li>
</ul></li>
<li>Step 2: Compute Covariance Matrix \( \mathbf{C}_{\mathbf X} = \frac{1}{n} \mathbf{X}^\top \mathbf{X} \,.\)

<ul>
<li>compute the outer product of each data point, </li>
<li>add together these outer products, and divide by the number of data points</li>
</ul></li>
</ul>

<p><img src="media/15124807146530/compute_covariance_matrix.png" alt="compute_covariance_matrix"/></p>

<p>Spark Code in Python:</p>

<pre><code class="language-python">def estimateCovariance(data):
    &quot;&quot;&quot;Compute the covariance matrix for a given rdd.
   
    Args:
        data (RDD of np.ndarray):  An `RDD` consisting of NumPy arrays.

    Returns:
        np.ndarray: A multi-dimensional array where the number of rows and columns both equal the length of the arrays in the input `RDD`.
    &quot;&quot;&quot;
    mean = data.mean()
    normalized = data.map(lambda x: x-mean)
    return normalized.map(lambda x: np.outer(x, x)).sum()/data.count()
</code></pre>

<h2 id="toc_1">Reference</h2>

<ol>
<li><a href="https://en.wikipedia.org/wiki/Covariance_matrix">Covariance matrix from wikipedia</a></li>
</ol>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2017/11/25</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0.html'>机器学习</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15114480120681.html">
                
                  <h1></h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h2 id="toc_0">real-world application v. s.competition</h2>

<p><img src="media/15114480120681/real%20machine%20learning.png" alt="real machine learning"/></p>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2017/11/23</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0.html'>机器学习</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="scalable%20machine%20learning.html">
                
                  <h1>CS190: Scalable Machine Learning</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<p>see <a href="http://larryim.cc/notebook.html">Labs here</a></p>

<h3 id="toc_0">Distributing Computing</h3>

<p>Need more hardware to store/process modern data</p>

<p>Scale-up(one big machine)</p>

<ul>
<li>Can be very fast for medium scale problems</li>
<li>Expensive, specialized hardware</li>
<li>Eventually hit a wall</li>
</ul>

<p>Scale-out (many small machine, i.e., distributed)</p>

<ul>
<li>Commodity hardware, scales to massive problems</li>
<li>Need to deal with network communication</li>
<li>Added software complexity</li>
</ul>

<p>Apache Spark is a general, open-source cluster computing engine.</p>

<p>Well-suited for machine learning</p>

<ul>
<li>Fast iterative computations</li>
<li>Efficient communication primitives</li>
<li>Simple and expressive: APIs in Scala, Java, Python, R</li>
<li>Integrated higher-level libraries (<code>MLlib</code>, Spark SQL, Spark Streaming, GraphX)</li>
</ul>

<h3 id="toc_1">Typical Supervised Learning Pipeline</h3>

<ul>
<li>Obtain Raw Data</li>
<li>Feature Extraction</li>
<li>Supervised Learning</li>
<li>Evaluation</li>
<li>Predict</li>
</ul>

<p><img src="media/15108151409015/Typical%20Supervised%20Learning%20Pipeline.png" alt="Typical Supervised Learning Pipeline"/></p>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2017/11/16</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0.html'>机器学习</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="machine_learning_techniques_SVM.html">
                
                  <h1>Machine Learning Techniques: Support Vector Machine (SVM)</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<ul>
<li>
<a href="#toc_0">Linear SVM</a>
<ul>
<li>
<a href="#toc_1">Standard Large-Margin Problem</a>
</li>
<li>
<a href="#toc_2">Support Vector Machine</a>
</li>
</ul>
</li>
<li>
<a href="#toc_3">Dual Support Vector Machine</a>
<ul>
<li>
<a href="#toc_4">Lagrange Dual Problem</a>
</li>
</ul>
</li>
</ul>


<h2 id="toc_0">Linear SVM</h2>

<p><img src="media/15088454152744/large_margin.png" alt="large_margin"/></p>

<p>Our goal is to find <code>largest-margin</code> separating hyperplane.</p>

<p><strong>Distance to Hyperplane</strong>: distance(\(x,b,w) = \frac{1}{\lVert w\rVert}|w^Tx+b|\)</p>

<h3 id="toc_1">Standard Large-Margin Problem</h3>

<p>Now the problem becomes:<br/>
<img src="media/15088454152744/hyperplane%20distance.png" alt="hyperplane distance"/></p>

<p><img src="media/15088454152744/standard%20problem.png" alt="standard proble"/></p>

<h3 id="toc_2">Support Vector Machine</h3>

<p><img src="media/15088454152744/svm%20with%20qp%20solver.png" alt="svm with qp solve"/></p>

<h2 id="toc_3">Dual Support Vector Machine</h2>

<p>\[\text{SVM} \equiv \min\limits_{b,w} (\max\limits_{\text{all}\,\alpha_n \ge 0} \mathcal{L}(b,w,\alpha))\]</p>

<h3 id="toc_4">Lagrange Dual Problem</h3>

<p>for any fixed \(\alpha&#39;\)  with all \(\alpha&#39;_n\ge\) 0,<br/>
\[\min\limits_{b,w} (\max\limits_{\text{all}\,\alpha_n \ge 0} \mathcal{L}(b,w,\alpha)) \ge \min\limits_{b,w}\mathcal{L}(b,w,\alpha&#39;)\]</p>

<p>for best \(\alpha&#39;\ge 0\) on RHS,</p>

<p>\[\min\limits_{b,w} (\max\limits_{\text{all}\,\alpha_n \ge 0} \mathcal{L}(b,w,\alpha)) \ge \max\limits_{\text{all}\,\alpha_n \ge 0}(\min\limits_{b,w}  \mathcal{L}(b,w,\alpha))\]</p>

<p>Strong duality of Quadratic Programming<br/>
\[\min\limits_{b,w} (\max\limits_{\text{all}\,\alpha_n \ge 0} \mathcal{L}(b,w,\alpha)) \ge \max\limits_{\text{all}\,\alpha_n \ge 0}(\min\limits_{b,w}  \mathcal{L}(b,w,\alpha))\]</p>

<ul>
<li>&#39;&gt;=&#39;: weak duality</li>
<li>&#39;=&#39;: strong duality, true for QP if

<ul>
<li>convex primal</li>
<li>feasible primal</li>
<li>linear constraints</li>
</ul></li>
</ul>

<p>Dual Formulation of Support Vector Machine:</p>

<p><img src="media/15088454152744/Screen%20Shot%202017-10-25%20at%201.43.46%20PM.png" alt="Screen Shot 2017-10-25 at 1.43.46 P"/></p>

<p><img src="media/15088454152744/Screen%20Shot%202017-10-25%20at%201.46.05%20PM.png" alt="Screen Shot 2017-10-25 at 1.46.05 P"/></p>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2017/10/24</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0.html'>机器学习</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15088244818278.html">
                
                  <h1>Machine Learning Foundations - Mathematical Foundations</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<ul>
<li>
<a href="#toc_0">(1) The Learning Problem</a>
<ul>
<li>
<a href="#toc_1">Key Essence of Machine Learning</a>
</li>
<li>
<a href="#toc_2">Formalize the Learning Problem</a>
</li>
<li>
<a href="#toc_3">Machine Learning and other Fields</a>
</li>
</ul>
</li>
<li>
<a href="#toc_4">(2) Learning to answer Yes or No</a>
<ul>
<li>
<a href="#toc_5">Perceptron Hypothesis Set</a>
</li>
</ul>
</li>
<li>
<a href="#toc_6">(3) Types of Learning</a>
<ul>
<li>
<a href="#toc_7">Learning with Different Output Space</a>
</li>
<li>
<a href="#toc_8">Learning with Different Data Label</a>
</li>
<li>
<a href="#toc_9">Learning with Different Protocol</a>
</li>
<li>
<a href="#toc_10">Learning with Different Input Space</a>
</li>
</ul>
</li>
<li>
<a href="#toc_11">(4) Feasibility of Learning</a>
<ul>
<li>
<a href="#toc_12">Learning outside training examples</a>
</li>
<li>
<a href="#toc_13">In and out of sample error</a>
</li>
<li>
<a href="#toc_14">Connection to Real Learning</a>
<ul>
<li>
<a href="#toc_15">Bound of BAD data</a>
</li>
<li>
<a href="#toc_16">The Statistical Learning Flow</a>
</li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#toc_17">(5) Training versus Testing</a>
<ul>
<li>
<a href="#toc_18">Dichotomy</a>
</li>
<li>
<a href="#toc_19">Growth function</a>
</li>
<li>
<a href="#toc_20">Shatter and Break point</a>
</li>
</ul>
</li>
<li>
<a href="#toc_21">(6) Theory of generalization</a>
<ul>
<li>
<a href="#toc_22">Bounding Function</a>
</li>
<li>
<a href="#toc_23">VC Bound</a>
</li>
</ul>
</li>
<li>
<a href="#toc_24">(7) VC dimension</a>
<ul>
<li>
<a href="#toc_25">Interpreting VC Dimension</a>
</li>
</ul>
</li>
<li>
<a href="#toc_26">(8): Noise and error</a>
<ul>
<li>
<a href="#toc_27">Error Measure</a>
</li>
</ul>
</li>
</ul>


<p>The course, Machine Learning Foundations - Mathematical Foundations(机器学习基石), is taught by Hsuan-Tien Lin on Coursera (<a href="https://www.coursera.org/learn/ntumlone-mathematicalfoundations/home/info">course info page</a>).</p>

<p>As the name of the course indicates, the course teaches the most fundamental algorithmic, theoretical, mathematical background of machine learning.</p>

<p>The article summaries the key concepts and conclusions in the course. Each section in the article corresponding to one chapter in the course.</p>

<h2 id="toc_0">(1) The Learning Problem</h2>

<h3 id="toc_1">Key Essence of Machine Learning</h3>

<p>Machine Learning: improving some <strong>performance measure</strong> with experience <strong>computed</strong> from <strong>data</strong></p>

<ul>
<li>exists some &#39;underlying pattern&#39; to be learned — so &#39;performance measure&#39; can be improved</li>
<li>but no programmable (easy) definition — so &#39;ML&#39; is needed</li>
<li>somehow there is data about the pattern — so ML has some &#39;inputs&#39; to learn from</li>
</ul>

<h3 id="toc_2">Formalize the Learning Problem</h3>

<p><strong>Basic Notations</strong>:</p>

<ul>
<li>input: \(x\in\mathcal{X}\)</li>
<li>output: \(y\in\mathcal{Y}\)</li>
<li>unknown pattern to be learned \(\Leftrightarrow\) target function:
\(f:\mathcal{X}\rightarrow\mathcal{Y}\) </li>
<li>data \(\Leftrightarrow\) training examples: \(\mathcal{D}={(x_1,y_1),(x_2,y_2),...,(x_N,y_N)}\)</li>
<li>hypothesis \(\Leftrightarrow\) skill with hopefully good performance: \(g: \mathcal{X}\rightarrow \mathcal{Y}\)</li>
<li>final hypothesis: \(\mathcal{g}\approx f\)</li>
</ul>

<p><strong>Machine Learning: use data \(\mathcal{D}\) to compute hypothesis \(g\) that approximates target \(f\).</strong></p>

<p><img src="media/15088244818278/Screen%20Shot%202017-11-07%20at%2012.35.17%20PM.png" alt="Screen Shot 2017-11-07 at 12.35.17 P"/></p>

<h3 id="toc_3">Machine Learning and other Fields</h3>

<ul>
<li>Machine Learning: use data to compute hypothesis \(g\) that approximates target \(f\)</li>
<li>Data Mining: Use (huge) data to find property that is interesting</li>
</ul>

<p>\(\Longleftrightarrow\)If &#39;interesting property&#39; same as &#39;hypothesis that approximate target&#39;, Machine Learning = Data Mining<br/>
\(\Longleftrightarrow\) If &#39;interesting property&#39; related to &#39;hypothesis that approximate target&#39;, data mining can help machine learning.<br/>
\(\Longleftrightarrow\) traditional data mining also focuses on efficient computation in large database.</p>

<h2 id="toc_4">(2) Learning to answer Yes or No</h2>

<h3 id="toc_5">Perceptron Hypothesis Set</h3>

<p>Vector Form of Perceptron Hypothesis:</p>

<p>\[h(x) = \text{sign}(\sum\limits_{i=0}^dw_ix_i)=\text{sign}(W^Tx)\]</p>

<p><strong>Perceptron Learning Algorithm</strong>(PLA):</p>

<p><img src="media/15088244818278/PLA.png" alt="PLA"/></p>

<p><strong>Pocket Algorithm</strong>: modify <code>PLA</code> algorithm by keeping best weights in pocket</p>

<p><img src="media/15088244818278/pocket.png" alt="pocket"/></p>

<h2 id="toc_6">(3) Types of Learning</h2>

<h3 id="toc_7">Learning with Different Output Space</h3>

<ul>
<li>binary classification: \(\mathcal{Y}=\{-1,+1\}\)</li>
<li>multiclass classification: \(\mathcal{Y}=\{1, 2,..., K\}\)</li>
<li>regression: \(\mathcal {Y} =\mathbb{R}\)</li>
<li>structured learning: \(\mathcal{Y}=\) structures</li>
</ul>

<h3 id="toc_8">Learning with Different Data Label</h3>

<ul>
<li>supervised: all \(y_n\)</li>
<li>unsupervised: no \(y_n\)</li>
<li>semi-supervised: some \(y_n\)</li>
<li>reinforcement: implicit \(y_n\) by goodness (\(\hat y_n\))</li>
</ul>

<h3 id="toc_9">Learning with Different Protocol</h3>

<p>Protocol \(\Longleftrightarrow\) Learning Philosophy.</p>

<ul>
<li>batch: all known data</li>
<li>online: sequential (passive) data</li>
<li>active: strategically-observed data</li>
</ul>

<h3 id="toc_10">Learning with Different Input Space</h3>

<ul>
<li>concrete: sophisticated (and related) physical meaning e.g. user features(age, sex, education level)</li>
<li>raw: simple physical meaning e.g. image features</li>
<li>abstract: no (or little) physical meaning e.g. user/image IDs</li>
</ul>

<h2 id="toc_11">(4) Feasibility of Learning</h2>

<h3 id="toc_12">Learning outside training examples</h3>

<p><strong>No Free Lunch</strong>: Learning from \(D\) (\(D\): training examples) (to infer something outside \(D\)) is doomed to fail if any unknown \(f\) can happen.</p>

<ul>
<li>\(g\approx f\) inside \(D\): Possible!</li>
<li>\(g\approx f\) outside \(D\): Impossible!</li>
</ul>

<h3 id="toc_13">In and out of sample error</h3>

<p>For any fixed \(h\), in &#39;big&#39; data (N large), <code>in-sample error</code> \(E_{in}(h)\) is probably close to <code>out-of-sample error</code> \(E_{out}(h)\) (within \(\epsilon\)):</p>

<p>\(P(|E_{in}(h)-E_{out}(h)|&gt; \epsilon) \le 2\exp(-2\epsilon^2N)\)</p>

<p>The equation above is called <code>Hoeffding&#39;s Inequality</code>. The statement \(E_{in}(h)=E_{out}(h)\) is <code>probably approximately correct</code> (<strong>PAC</strong>, 大概近似正确).</p>

<p>If large \(N\), we can <strong>probably</strong> infer unknown \(E_{out}(h)\) by known \(E_{in}(h)\).</p>

<p><code>in-sample error</code> \(E_{in}(h)\) denotes orange fraction in sample, <code>out-of-sample error</code> \(E_{out}(h)\) denotes orange probability in bin, When we want to infer the orange probability in bin.</p>

<p><img src="media/15088244818278/Ein_Eout.png" alt="Ein_Eout"/></p>

<p><img src="media/15088244818278/Connection%20to%20Learning.png" alt="Connection to Learning"/></p>

<h3 id="toc_14">Connection to Real Learning</h3>

<p><strong>Bad data for One \(h\)</strong>: </p>

<p>\(E_{out}(h)\) and \(E_{in}(h)\) far away: e.g. \(E_{out}\) big (far from \(f\)), but \(E_{in}\) small (correct on most examples).</p>

<p><strong>Bad data for many \(h\)</strong>:</p>

<p>\(\Leftrightarrow\) no &#39;freedom of choices&#39; by learning algorithm \(\mathcal{A}\)<br/>
\(\Leftrightarrow\) there exists some \(h\) such that \(E_{out}(h)\) and \(E_{in}(h)\) far away</p>

<h4 id="toc_15">Bound of BAD data</h4>

<p>Form \(M\) hypotheses, what is the bound of \(\mathbb{P}_{\mathcal{D}} [\text{BAD} \; \mathcal{D}]\)</p>

<p><img src="media/15088244818278/bound_of_bad_data.png" alt="bound of bad data"/></p>

<p>The <code>union bound</code> <a href="https://en.wikipedia.org/wiki/Boole%27s_inequality">WIKI</a> (布尔不等式), also known as <code>Boole&#39;s inequality</code>, says that for any finite or countable set of events, the probability that at least one of the events happens is no greater than the sum of the probabilities of the individual events.</p>

<h4 id="toc_16">The Statistical Learning Flow</h4>

<p>If \(|\mathcal{H}|=M\) finite, \(N\) large enough, for whatever \(g\) picked by \(\mathcal{A}\), \(E_{out}(g)\approx E_{in}(g)\)</p>

<p>if \(\mathcal{A}\) finds one \(g\) with \(E_{in}(g)\approx 0\),<br/>
PAC gaurantee for \(E_{out}(g)\approx 0\) \(\rightarrow\) learning possilbe!</p>

<h2 id="toc_17">(5) Training versus Testing</h2>

<p>For batch and supervised binary classification, \(g\approx f\Longleftrightarrow E_{out}(g)\approx 0\) achieved through \(E_{out}(g)\approx E_{in}(g)\) and \(E_{in}(g)\approx 0\).</p>

<p>In order to achieve two conditions above, learning split to two central questions:</p>

<ul>
<li>Can we make sure that \(E_{out}(g)\) is close enough to \(E_{in}(g)\)?</li>
<li>Can we make \(E_{in}(g)\) small enough?</li>
</ul>

<p>In order to understand trade-off for &#39;right&#39; \(\mathcal{H}\), we establish a finite quantity that replace \(M\),</p>

<p>\[\mathbb{P}[|E_{in}9g)-E_{out}(g)|&gt;\epsilon] \le 2\cdot m_\mathcal{H} \cdot \exp(-2\epsilon^2 N)\]</p>

<h3 id="toc_18">Dichotomy</h3>

<p>Define hypothesis set \(\mathcal{H}\):</p>

<p>\(\mathcal{H}=\{\text{hypothesis}\quad h: \mathcal{X}\rightarrow{\text{x,o}}\}\)</p>

<p>And we call hypothesis &#39;limited&#39; to the eyes of \(x_1, x_2,..., x_N\) a dichotomy:</p>

<p>\[\mathcal{H}(x_1,x_2,...,x_N)=\{(h(x_1),h(x_2),...,h(x_N)) \quad | \quad h \in \mathcal{H} \}\]</p>

<p>One can think of the dichotomies \(\mathcal{H}(x_1,x_2,...,x_N)\) as a set of hypotheses just like \(\mathcal{H}\)  is, except that the hypotheses are seen through the eyes of \(N\) points only.</p>

<p><strong>Note</strong>: hypotheses \(\mathcal{H}\) and dichotomy \(\mathcal{H}(x_1,x_2,...,x_N)\) are different!</p>

<h3 id="toc_19">Growth function</h3>

<p>Growth function is <strong>the maximum number of dichotomies</strong> that can be generated by \(\mathcal{H}\) on <strong>any</strong> \(N\) points: </p>

<p>\[m_\mathcal{H}(N) = \max\limits_{x_1,x_2,...,x_N\in\mathcal{X}}|\mathcal{H}(x_1,x_2,...,x_N)|\]</p>

<p>Growth function is finite, its upper-bound is \(2^N\).</p>

<p>Growth functions in different situation:</p>

<ul>
<li>positive rays: \(m_\mathcal{H}(N)=N+1\)</li>
<li>positive intervals: \(m_\mathcal{H}(N)=\frac{1}{2}N^2+\frac{1}{2}N+1\)</li>
<li>convex sets: \(m_\mathcal{H}(N)=2^N \)</li>
<li>2D perceptrons: \(m_\mathcal{H}(N)=2^N \text{in some cases}\)</li>
</ul>

<h3 id="toc_20">Shatter and Break point</h3>

<p><strong>If no \(k\) inputs can be shattered by \(\mathcal{H}\) , call \(k\) a break point for \(\mathcal{H}\).</strong></p>

<p>if \(m_H(K) &lt; 2^k\), call k a <strong>break point</strong> for \(\mathcal{H}\).</p>

<ul>
<li>since \(k\) is a break point, \(k+1, k+2, k+3,...,\) also break points</li>
</ul>

<p>minimum break points for different \(\mathcal{H}\):</p>

<ul>
<li>positive rays: k=2</li>
<li>positive intervals: k=3</li>
<li>convex sets: none</li>
<li>2D perceptrons: k=4</li>
</ul>

<h2 id="toc_21">(6) Theory of generalization</h2>

<h3 id="toc_22">Bounding Function</h3>

<p>Bounding Function \(B(N,k)\) is maximum possible \(m_\mathcal{H}(N)\) when break point \(=k\).</p>

<p>\[B(N,k) \le \sum\limits_{i=0}^{k-1} \left(\stackrel N i\right)\]</p>

<p><u>For fixed</u> \(k, B(N,k)\) <u>upper bounded by</u> \(ploy(N)\), \(\rightarrow m_{\mathcal{H}}(N)\) is \(poly(N)\) <u>if break point exists</u>.</p>

<h3 id="toc_23">VC Bound</h3>

<p>When N large enough, </p>

<p>\[P[\exists h\in \mathcal{H} \quad s.t.\quad  |E_{in}(h)-E_{out}(h)|&gt; \epsilon]\le 4 m_\mathcal{H}(2N)\exp(-\frac{1}{8}\epsilon^2N)\]</p>

<p>The above equation called <u><strong>Vapnik-Chervonenkis (VC) bound</strong></u>.</p>

<h2 id="toc_24">(7) VC dimension</h2>

<p>VC dimension, the formal name of <strong>maximum non-break point</strong>, denoted \(d_{VC}(\mathcal{H})\), is </p>

<p>\[\text{largest N for which } m_{\mathcal{H}}(N)=2^N\]</p>

<ul>
<li>positive rays: \(d_{VC}=1\)</li>
<li>positive intervals: \(d_{VC}=2\)</li>
<li>convex sets: \(d_{VC}= \infty \)</li>
<li>2D perceptrons: \(d_{VC}=3\)</li>
<li>d dimension Perceptrons: \(d_{VC}=d+1\)</li>
</ul>

<h3 id="toc_25">Interpreting VC Dimension</h3>

<p><img src="media/15088244818278/the%20vc%20message.png" alt="the vc message"/><br/>
<img src="media/15088244818278/the%20vc%20message2.png" alt="the vc message2"/></p>

<h2 id="toc_26">(8): Noise and error</h2>

<p><strong>Noise</strong> in \(x\) and \(y\):</p>

<p><img src="media/15088244818278/Noises.png" alt="Noises"/></p>

<p>NOTE: <strong>VC holds for \(x \stackrel{i.i.d}{\backsim} P(x), y \stackrel{i.i.d}{\backsim} P(y|x)\)</strong></p>

<p><img src="media/15088244818278/New%20Learning%20Law.png" alt="New Learning Law"/></p>

<h3 id="toc_27">Error Measure</h3>

<p>Two Important Pointwise Error Measures</p>

<p><strong>0/1 error</strong>(often for classification): err(\(\tilde y,y)=[\tilde y\ne y]\) <br/>
<strong>squared error</strong>(often for regression): err(\(\tilde y,y)=(\tilde y\ne y)^2\)</p>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2017/10/24</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0.html'>机器学习</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
              


			<div class="row">
			  <div class="large-6 columns">
			  <p class="text-left" style="padding-top:25px;">
			   
			  </p>
			  </div>
			  <div class="large-6 columns">
			<p class="text-right" style="padding-top:25px;">
			 <a href="机器学习_1.html">&raquo; Next Page</a> 
			</p>
			  </div>
			</div>
		</div>
	</div><!-- large 8 -->

 <div class="large-4 medium-4 columns">
  <div class="hide-for-small">
    <div id="sidebar" class="sidebar">
          <div id="site-info" class="site-info">
            
                <div class="site-a-logo"><img src="http://or9a8nskt.bkt.clouddn.com/figure.jpeg" /></div>
            
                <h1>techlarry</h1>
                <div class="site-des">他山之石，可以攻玉</div>
                <div class="social">









<a target="_blank" class="github" target="_blank" href="https://github.com/techlarry" title="GitHub">GitHub</a>
<a target="_blank" class="email" href="mailto:wang.zhen.hua.larry@gmail.com" title="Email">Email</a>
  <a target="_blank" class="rss" href="atom.xml" title="RSS">RSS</a>
                
              	 </div>
          	</div>

             

              <div id="site-categories" class="side-item ">
                <div class="side-header">
                  <h2>Categories</h2>
                </div>
                <div class="side-content">

      	<p class="cat-list">
        
            <a href="Leetcode.html"><strong>Leetcode</strong></a>
        
            <a href="C/C++.html"><strong>C/C++</strong></a>
        
            <a href="Python%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95.html"><strong>Python数据结构与算法</strong></a>
        
            <a href="Python%E7%89%B9%E6%80%A7.html"><strong>Python特性</strong></a>
        
            <a href="%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0.html"><strong>机器学习</strong></a>
        
            <a href="Python%E7%A7%91%E5%AD%A6%E8%AE%A1%E7%AE%97%E4%B8%89%E7%BB%B4%E5%8F%AF%E8%A7%86%E5%8C%96.html"><strong>Python科学计算三维可视化</strong></a>
        
            <a href="English.html"><strong>English</strong></a>
        
            <a href="Computer%20System.html"><strong>Computer System</strong></a>
        
            <a href="Deep%20Learning.html"><strong>Deep Learning</strong></a>
        
            <a href="Latex.html"><strong>Latex</strong></a>
        
            <a href="%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html"><strong>操作系统</strong></a>
        
            <a href="Linux%20%E7%B3%BB%E7%BB%9F%E7%BC%96%E7%A8%8B.html"><strong>Linux 系统编程</strong></a>
        
            <a href="%E6%95%B0%E6%8D%AE%E5%BA%93.html"><strong>数据库</strong></a>
        
            <a href="Tensorflow.html"><strong>Tensorflow</strong></a>
        
            <a href="Big%20Data.html"><strong>Big Data</strong></a>
        
            <a href="%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB.html"><strong>文献阅读</strong></a>
         
        </p>


                </div>
              </div>

              <div id="site-categories" class="side-item">
                <div class="side-header">
                  <h2>Recent Posts</h2>
                </div>
                <div class="side-content">
                <ul class="posts-list">
	      
		      
			      <li class="post">
			        <a href="15124807146530.html">Covariance Matrix and its application in Spark</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15114480120681.html"></a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15114445635476.html">MongoDB</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15108229432607.html">`Filter`, `Map`, `Reduce`</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="scalable%20machine%20learning.html">CS190: Scalable Machine Learning</a>
			      </li>
		     
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		   
		  		</ul>
                </div>
              </div>
        </div><!-- sidebar -->
      </div><!-- hide for small -->
</div><!-- large 4 -->

</div><!-- row -->

 <div class="page-bottom clearfix">
  <div class="row">
   
  </div>
</div>

        </section>
      </div>
    </div>

  
    

    <script src="asset/js/foundation.min.js"></script>
    <script>
      $(document).foundation();
      function fixSidebarHeight(){
        var w1 = $('.markdown-body').height();
          var w2 = $('#sidebar').height();
          if (w1 > w2) { $('#sidebar').height(w1); };
      }
      $(function(){
        fixSidebarHeight();
      })
      $(window).load(function(){
          fixSidebarHeight();
      });
     
    </script>

    <script src="asset/chart/all-min.js"></script><script type="text/javascript">$(function(){    var mwebii=0;    var mwebChartEleId = 'mweb-chart-ele-';    $('pre>code').each(function(){        mwebii++;        var eleiid = mwebChartEleId+mwebii;        if($(this).hasClass('language-sequence')){            var ele = $(this).addClass('nohighlight').parent();            $('<div id="'+eleiid+'"></div>').insertAfter(ele);            ele.hide();            var diagram = Diagram.parse($(this).text());            diagram.drawSVG(eleiid,{theme: 'simple'});        }else if($(this).hasClass('language-flow')){            var ele = $(this).addClass('nohighlight').parent();            $('<div id="'+eleiid+'"></div>').insertAfter(ele);            ele.hide();            var diagram = flowchart.parse($(this).text());            diagram.drawSVG(eleiid);        }    });});</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({TeX: { equationNumbers: { autoNumber: "AMS" } }});</script>


  </body>
</html>
